# Hexxagon Go

Hexxagon Go 是一款使用 Go 语言编写的六角棋（Hexxagon）对战游戏，实现了棋盘规则、图形界面、音效以及多种人机策略。
中文译名:疯狂跳棋、征服六边形、水晶棋 等。

## 🎮 游戏简介

Hexxagon 的棋盘由 4 格半径的六角蜂窝组成，棋手的目标是在棋盘填满或一方无法行动前，占据更多的格子。

## 🧩 棋盘元素

- `空格`：可以放置或经过棋子的普通位置。
- `障碍`：不可用的格子，不允许任何棋子进入。
- `红方/白方`：双方棋子的当前位置。

## ➡️ 移动规则

棋手在自己的回合可以选择任意一个己方棋子，进行以下两种移动之一：

1. **克隆移动**：移动到距离 1 的邻居格，原位置保留棋子，新格子生成一枚新的己方棋子。
2. **跳跃移动**：跨过一个格子跳到距离 2 的位置，原位置变为空格。

## 🔄 感染机制

无论是克隆还是跳跃，当棋子落子后，所有紧邻的对方棋子都会被“感染”并立刻变成己方棋子。

## 🏁 胜负判定

- 棋盘无空位或一方没有合法走法时，游戏结束。
- 结束时棋子数量更多的一方获胜。

## 🚀 快速开始
```
# 人机对战（默认人机对战）
./hexxagon

# 人机对战并开启评分提示（深度 4）
./hexxagon --tip=true

# 双人对战
./hexxagon --mode=pvp
```

## 🤖 人机对战实现思路

- 搜索入口采用迭代加深与根节点并行，在生成全部合法着法后按启发式得分排序。
- 静态评估来自 `internal/game/evaluate.go`，综合棋子数量、抢占边缘、紧密三角等特征，并在搜索过程中根据局面动态加权。
- 每层递归使用 Alpha-Beta 剪枝配合置换表（`tt.go`）缓存结果，对不同走子方及时调整上下界以减少分支。
- 搜索过程中结合策略裁剪、危险跳跃过滤、感染数预估等规则，剔除风险较高的着法并提升稳定性。
- 当启用 `-tip` 参数时，UI 会对候选落点执行同样深度为 4 的搜索，为人类玩家实时展示评分提示。

## 🧠 CNN 模型训练

- 训练数据来自自对弈对局。
- 训练代码 基于 PyTorch DDP 与 AMP 训练深度 CNN，对 81 格棋盘进行 6 次旋转/镜像数据增强(12倍增广)，可按需启用多 GPU。
- 训练完成后输出 `hex_cnn.pt`，再通过 `export_hex_cnn_to_onnx.py` 转换为 `assets/hex_cnn.onnx`，供 `internal/ml/onnx_infer.go` 在游戏中进行推理评分。

## 🧮 推理设备选择

- **GPU 推理（Windows/CUDA）**：将 `onnxruntime_providers_cuda.dll`、`onnxruntime_providers_tensorrt.dll`、`cudnn*_9.dll` 等文件放在可执行文件同目录，并设置 `ONNXRUNTIME_SHARED_LIBRARY_PATH` 指向 GPU 版 `onnxruntime.dll`。
- **CPU 推理**：若缺少上述 CUDA 依赖或在其他操作系统上运行，程序会自动回退至 CPU 推理,自动解压CPU推理的dll文件，无需任何额外配置。

## 📜 许可说明

- 本项目可免费用于学习、研究及非商业用途，使用时请注明仓库链接及作者信息。
- 严禁任何形式的商业使用（包括二次打包、付费分发或内嵌收费服务等）。
